<div class="usuarios-container">
  <h2>GestiÃ³n de Usuarios</h2>

  <!-- ğŸ”¹ Controles superiores -->
  <div class="top-bar">
    <!-- BotÃ³n agregar -->
    <button class="btn-agregar" (click)="agregarUsuario()">â• Agregar Usuario</button>

    <!-- Barra de bÃºsqueda -->
    <input type="text" [(ngModel)]="filtro" placeholder="ğŸ” Buscar por nombre o correo..." class="search-input" />
  </div>

  <!-- Indicadores de carga o error -->
  <div *ngIf="loading" class="mensaje info">Cargando usuarios...</div>
  <div *ngIf="error" class="mensaje error">{{ error }}</div>

  <!-- Tabla de usuarios -->
  <div *ngIf="!loading && usuariosFiltrados.length > 0" class="tabla-responsive">
    <table class="usuarios-tabla">
      <thead>
        <tr>
          <th>DNI</th>
          <th>Nombres</th>
          <th>Apellidos</th>
          <th>Correo</th>
          <th>Rol</th>
          <th>ID Cargo</th>
          <th>Usuario</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of usuariosFiltrados">
          <td>{{ usuario.dni }}</td>
          <td>{{ usuario.nombres }}</td>
          <td>{{ usuario.apellidos }}</td>
          <td>{{ usuario.correo }}</td>
          <td>
            <span class="badge-rol" [ngClass]="{
              'rol-admin': usuario.nombreRol?.toLowerCase() === 'admin',
              'rol-tecnico': usuario.nombreRol?.toLowerCase() === 'tecnico',
              'rol-usuario': usuario.nombreRol?.toLowerCase() === 'usuario'
            }">
              {{ usuario.nombreRol }}
            </span>
          </td>
          <td>{{ getNombreCargo(usuario.idCargo) }}</td>
          <td>{{ usuario.usuario }}</td>
          <td>
            <button class="btn-ver" (click)="verDetalle(usuario.dni)">ğŸ‘</button>
            <button class="btn-editar" (click)="editarUsuario(usuario.dni)">âœï¸</button>
            <button class="btn-eliminar" (click)="abrirModalEliminar(usuario.dni)">ğŸ—‘ï¸</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && usuariosFiltrados.length === 0" class="mensaje vacio">
    No se encontraron usuarios.
  </div>

  <!-- MODAL DE CONFIRMACIÃ“N -->
  <div *ngIf="mostrarModalEliminar" class="modal-overlay" (click)="cerrarModalEliminar()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h3>Â¿Eliminar usuario?</h3>
      <p>Esta acciÃ³n no se puede deshacer. Â¿EstÃ¡ seguro de que desea eliminar este usuario?</p>
      <div class="modal-actions">
        <button class="btn-cancel" (click)="cerrarModalEliminar()">Cancelar</button>
        <button class="btn-danger" (click)="confirmarEliminar()">Eliminar</button>
      </div>
    </div>
  </div>

  <!-- MENSAJES -->
  <div *ngIf="mensaje" class="mensaje-flotante" [ngClass]="tipoMensaje">
    {{ mensaje }}
  </div>
</div>